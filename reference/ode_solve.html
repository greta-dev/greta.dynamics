<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Solve a system of ordinary differential equations."><title>solve ODEs — ode_solve • greta.dynamics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="solve ODEs — ode_solve"><meta property="og:description" content="Solve a system of ordinary differential equations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">greta.dynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/iterate-matrix-example.html">iterate-matrix-example</a>
    <a class="dropdown-item" href="../articles/ode-solve-example.html">ode-solve-example</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/greta-dev/greta.dynamics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>solve ODEs</h1>
      <small class="dont-index">Source: <a href="https://github.com/greta-dev/greta.dynamics/blob/HEAD/R/ode_solve.R" class="external-link"><code>R/ode_solve.R</code></a></small>
      <div class="d-none name"><code>ode_solve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Solve a system of ordinary differential equations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ode_solve</span><span class="op">(</span><span class="va">derivative</span>, <span class="va">y0</span>, <span class="va">times</span>, <span class="va">...</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ode45"</span>, <span class="st">"rk4"</span>, <span class="st">"midpoint"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>derivative</dt>
<dd><p>a derivative function. The first two arguments must be 'y'
and 't', the state parameter and scalar timestep respectively. The
remaining parameters must be named arguments representing (temporally
static) model parameters. Variables and distributions cannot be defined in
the function.</p></dd>


<dt>y0</dt>
<dd><p>a greta array for the value of the state parameter y at time 0</p></dd>


<dt>times</dt>
<dd><p>a column vector of times at which to evaluate y</p></dd>


<dt>...</dt>
<dd><p>named arguments giving greta arrays for the additional (fixed)
parameters</p></dd>


<dt>method</dt>
<dd><p>which solver to use. <code>"ode45"</code> uses adaptive step
sizes, whilst <code>"rk4"</code> and <code>"midpoint"</code> use the fixed grid defined
by <code>times</code>; they may be faster but less accurate than <code>"ode45"</code>.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># replicate the Lotka-Volterra example from deSolve</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LVmod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Time</span>, <span class="va">State</span>, <span class="va">Pars</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">State</span>, <span class="va">Pars</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">Ingestion</span> <span class="op">&lt;-</span> <span class="va">rIng</span>  <span class="op">*</span> <span class="va">Prey</span> <span class="op">*</span> <span class="va">Predator</span></span></span>
<span class="r-in"><span>    <span class="va">GrowthPrey</span> <span class="op">&lt;-</span> <span class="va">rGrow</span> <span class="op">*</span> <span class="va">Prey</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Prey</span> <span class="op">/</span> <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">MortPredator</span> <span class="op">&lt;-</span> <span class="va">rMort</span> <span class="op">*</span> <span class="va">Predator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">dPrey</span> <span class="op">&lt;-</span> <span class="va">GrowthPrey</span> <span class="op">-</span> <span class="va">Ingestion</span></span></span>
<span class="r-in"><span>    <span class="va">dPredator</span> <span class="op">&lt;-</span> <span class="va">Ingestion</span> <span class="op">*</span> <span class="va">assEff</span> <span class="op">-</span> <span class="va">MortPredator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dPrey</span>, <span class="va">dPredator</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pars</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rIng <span class="op">=</span> <span class="fl">0.2</span>,  <span class="co"># /day, rate of ingestion</span></span></span>
<span class="r-in"><span>           rGrow <span class="op">=</span> <span class="fl">1.0</span>,  <span class="co"># /day, growth rate of prey</span></span></span>
<span class="r-in"><span>           rMort <span class="op">=</span> <span class="fl">0.2</span>,  <span class="co"># /day, mortality rate of predator</span></span></span>
<span class="r-in"><span>           assEff <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># -, assimilation efficiency</span></span></span>
<span class="r-in"><span>           K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># mmol/m3, carrying capacity</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">yini</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Prey <span class="op">=</span> <span class="fl">1</span>, Predator <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span><span class="va">yini</span>, <span class="va">times</span>, <span class="va">LVmod</span>, <span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate observations</span></span></span>
<span class="r-in"><span><span class="va">jitter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_obs</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">jitter</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ~~~~~~~~~</span></span></span>
<span class="r-in"><span><span class="co"># fit a greta model to infer the parameters from this simulated data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># greta version of the function</span></span></span>
<span class="r-in"><span><span class="va">lotka_volterra</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">t</span>, <span class="va">rIng</span>, <span class="va">rGrow</span>, <span class="va">rMort</span>, <span class="va">assEff</span>, <span class="va">K</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">Prey</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">Predator</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Ingestion</span>    <span class="op">&lt;-</span> <span class="va">rIng</span>  <span class="op">*</span> <span class="va">Prey</span> <span class="op">*</span> <span class="va">Predator</span></span></span>
<span class="r-in"><span>  <span class="va">GrowthPrey</span>   <span class="op">&lt;-</span> <span class="va">rGrow</span> <span class="op">*</span> <span class="va">Prey</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Prey</span> <span class="op">/</span> <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">MortPredator</span> <span class="op">&lt;-</span> <span class="va">rMort</span> <span class="op">*</span> <span class="va">Predator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">dPrey</span>        <span class="op">&lt;-</span> <span class="va">GrowthPrey</span> <span class="op">-</span> <span class="va">Ingestion</span></span></span>
<span class="r-in"><span>  <span class="va">dPredator</span>    <span class="op">&lt;-</span> <span class="va">Ingestion</span> <span class="op">*</span> <span class="va">assEff</span> <span class="op">-</span> <span class="va">MortPredator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dPrey</span>, <span class="va">dPredator</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># priors for the parameters</span></span></span>
<span class="r-in"><span><span class="va">rIng</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># /day, rate of ingestion</span></span></span>
<span class="r-in"><span><span class="va">rGrow</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>  <span class="co"># /day, growth rate of prey</span></span></span>
<span class="r-in"><span><span class="va">rMort</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># /day, mortality rate of predator</span></span></span>
<span class="r-in"><span><span class="va">assEff</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># -, assimilation efficiency</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>  <span class="co"># mmol/m3, carrying capacity</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># initial values and observation error</span></span></span>
<span class="r-in"><span><span class="va">y0</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obs_sd</span> <span class="op">&lt;-</span> <span class="fu">uniform</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># solution to the ODE</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">ode_solve</span><span class="op">(</span><span class="va">lotka_volterra</span>, <span class="va">y0</span>, <span class="va">times</span>, <span class="va">rIng</span>, <span class="va">rGrow</span>, <span class="va">rMort</span>, <span class="va">assEff</span>, <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sampling statement/observation model</span></span></span>
<span class="r-in"><span><span class="fu">distribution</span><span class="op">(</span><span class="va">y_obs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">normal</span><span class="op">(</span><span class="va">y</span>, <span class="va">obs_sd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we can use greta to solve directly, for a fixed set of parameters (the true</span></span></span>
<span class="r-in"><span><span class="co"># ones in this case)</span></span></span>
<span class="r-in"><span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu">calculate</span><span class="op">(</span><span class="va">y</span>, values <span class="op">=</span> <span class="va">values</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">times</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">vals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="va">times</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">y_obs</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="va">times</span>, pch <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or we can do inference on the parameters:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># build the model (takes a few seconds to define the tensorflow graph)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">model</span><span class="op">(</span><span class="va">rIng</span>, <span class="va">rGrow</span>, <span class="va">rMort</span>, <span class="va">assEff</span>, <span class="va">K</span>, <span class="va">obs_sd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute MAP estimate</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">opt</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nick Golding.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

